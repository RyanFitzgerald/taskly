"use strict";!function(){var e=document.getElementById("todo-input-field"),t=document.getElementById("todo-input-submit"),n=document.getElementById("todo-list"),o=document.getElementById("todo-list-complete"),i=document.getElementById("todo-summary"),s=document.getElementById("todo-summary-toggle"),a={incomplete:{},complete:{}};Sortable.create(n,{animation:150,onEnd:function(){f()}});var d=function(e,t,i){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],d=document.createElement("li");d.setAttribute("class","todo-item"),d.dataset.createdOn=t,d.dataset.completedOn=s,d.innerHTML='\n            <div class="todo-item-wrap">\n                <div class="todo-item-complete"><span><i class="fa fa-check" aria-hidden="true"></i></span></div>\n                <div class="todo-item-content">'+e+'</div>\n                <div class="todo-item-content-edit"><input type="text" class="todo-item-edit-field"></div>\n                <div class="todo-item-edit-options">\n                    <div class="todo-item-edit-confirm"><span><i class="fa fa-check" aria-hidden="true"></i></span></div>\n                    <div class="todo-item-edit-cancel"><span><i class="fa fa-times" aria-hidden="true"></i></span></div>\n                </div>\n                <div class="todo-item-options">\n                    <div class="todo-item-edit"><span><i class="fa fa-pencil" aria-hidden="true"></i></span></div>\n                    <div class="todo-item-delete"><span><i class="fa fa-trash-o" aria-hidden="true"></i></span></div>\n                </div>\n            </div>\n            <div class="todo-item-completed"><span>Completed!</span></div>\n            <div class="todo-item-deleted"><span>Deleted!</span></div>\n        ',l(d.getElementsByClassName("todo-item-complete")[0]),c(d.getElementsByClassName("todo-item-edit")[0]),m(d.getElementsByClassName("todo-item-edit-field")[0]),r(d.getElementsByClassName("todo-item-edit-confirm")[0]),v(d.getElementsByClassName("todo-item-edit-cancel")[0]),p(d.getElementsByClassName("todo-item-delete")[0]),u(),s?(o.append(d),d.classList.add("completed"),d.setAttribute("id","todocomplete-"+i),a.complete[i]={todo:e,created:t,completed:s}):(n.append(d),d.setAttribute("id","todo-"+i),a.incomplete[i]={todo:e,created:t,completed:s}),g()},l=function(e){var t=e.parentNode.parentNode,n=e.parentNode,o=t.getElementsByClassName("todo-item-completed")[0],i="false"!==t.dataset.completedOn;e.addEventListener("click",function(){i?(t.remove(),d(t.getElementsByClassName("todo-item-content")[0].innerHTML,t.dataset.createdOn,t.id.split("-")[1]),f()):(o.height=t.height,o.classList.add("active"),n.classList.add("slide"),setTimeout(function(){t.remove(),d(t.getElementsByClassName("todo-item-content")[0].innerHTML,t.dataset.createdOn,t.id.split("-")[1],moment().format("YYYY-MM-DD")),f()},750))})},m=function(e){var t=e.parentNode.parentNode;e.addEventListener("keyup",function(n){if(13===n.keyCode){if(""===e.value)return;t.getElementsByClassName("todo-item-content")[0].innerHTML=e.value,t.getElementsByClassName("todo-item-content")[0].classList.remove("inactive"),t.getElementsByClassName("todo-item-content-edit")[0].classList.remove("active"),t.classList.remove("active"),f()}})},c=function(e){var t=e.parentNode.parentNode;e.addEventListener("click",function(){t.getElementsByClassName("todo-item-content")[0].classList.add("inactive"),t.getElementsByClassName("todo-item-edit-field")[0].value=t.getElementsByClassName("todo-item-content")[0].innerHTML,t.getElementsByClassName("todo-item-content-edit")[0].classList.add("active"),t.getElementsByClassName("todo-item-edit-field")[0].select(),t.classList.add("active")})},r=function(e){var t=e.parentNode.parentNode,n=t.getElementsByClassName("todo-item-edit-field")[0];e.addEventListener("click",function(){""!==n.value&&(t.getElementsByClassName("todo-item-content")[0].innerHTML=n.value,t.getElementsByClassName("todo-item-content")[0].classList.remove("inactive"),t.getElementsByClassName("todo-item-content-edit")[0].classList.remove("active"),t.classList.remove("active"),f())})},v=function(e){var t=e.parentNode.parentNode;e.addEventListener("click",function(){t.getElementsByClassName("todo-item-content")[0].classList.remove("inactive"),t.getElementsByClassName("todo-item-content-edit")[0].classList.remove("active"),t.getElementsByClassName("todo-item-edit")[0].getElementsByTagName("span")[0].classList.remove("active"),t.classList.remove("active")})},p=function(e){var t=e.parentNode.parentNode.parentNode,n=e.parentNode.parentNode;e.addEventListener("click",function(){t.getElementsByClassName("todo-item-deleted")[0].height=t.clientHeight,t.getElementsByClassName("todo-item-deleted")[0].classList.add("active"),n.classList.add("slide"),setTimeout(function(){t.remove(),f()},750)})},u=function(){e.value=""},f=function(){var e=n.getElementsByClassName("todo-item"),t=o.getElementsByClassName("todo-item");if(a={incomplete:{},complete:{}},e.length>0)for(var i=0;i<e.length;i++)e[i].id="todo-"+(i+1),a.incomplete[i+1]={todo:e[i].getElementsByClassName("todo-item-content")[0].innerHTML,created:e[i].dataset.createdOn,completed:e[i].dataset.completedOn};if(t.length>0)for(var s=0;s<t.length;s++)t[s].id="todocomplete-"+(s+1),a.complete[s+1]={todo:t[s].getElementsByClassName("todo-item-content")[0].innerHTML,created:t[s].dataset.createdOn,completed:t[s].dataset.completedOn};g()},g=function(){chrome.storage.sync.remove("list",function(){chrome.storage.sync.set({list:a},function(){console.log("List updated.")})})},y=function(){chrome.storage.sync.get("list",function(e){for(var t in e.list.incomplete)if(e.list.incomplete.hasOwnProperty(t)){var n=e.list.incomplete[t];d(n.todo,n.created,t)}for(var o in e.list.complete)if(e.list.complete.hasOwnProperty(o)){var i=e.list.complete[o];d(i.todo,i.created,o,i.completed)}})},E=function(){y(),e.addEventListener("keyup",function(t){if(13===t.keyCode){if(""===e.value)return;d(e.value,moment().format("YYYY-MM-DD"),document.getElementsByClassName("todo-item").length+1)}}),t.addEventListener("click",function(){""!==e.value&&d(e.value,moment().format("YYYY-MM-DD"),document.getElementsByClassName("todo-item").length+1)}),s.addEventListener("click",function(){i.classList.contains("active")?i.classList.remove("active"):i.classList.add("active")})};document.addEventListener("DOMContentLoaded",E)}();