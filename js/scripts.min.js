"use strict";!function(){var e=document.getElementById("todo-input-field"),t=document.getElementById("todo-input-submit"),n=document.getElementById("todo-list"),a=document.getElementById("todo-summary"),o=document.getElementById("todo-summary-toggle"),m=document.getElementById("todo-summary-day"),s=document.getElementById("todo-summary-week"),i=document.getElementById("todo-summary-month"),d=document.getElementById("todo-summary-year"),c=document.getElementById("todo-summary-all"),l={},r={daySummary:{count:0,date:null},weekSummary:{count:0,date:null},monthSummary:{count:0,date:null},yearSummary:{count:0,date:null},allSummary:0};Sortable.create(n,{animation:150,onEnd:function(){B()}});var u=function(e,t,a){var o=document.createElement("li");o.setAttribute("class","todo-item"),o.setAttribute("id","todo-"+a),o.dataset.createdOn=t,o.innerHTML='\n            <div class="todo-item-wrap">\n                <div class="todo-item-complete"><span><i class="fa fa-check" aria-hidden="true"></i></span></div>\n                <div class="todo-item-content">'+e+'</div>\n                <div class="todo-item-content-edit"><input type="text" class="todo-item-edit-field"></div>\n                <div class="todo-item-edit-options">\n                    <div class="todo-item-edit-confirm"><span><i class="fa fa-check" aria-hidden="true"></i></span></div>\n                    <div class="todo-item-edit-cancel"><span><i class="fa fa-times" aria-hidden="true"></i></span></div>\n                </div>\n                <div class="todo-item-options">\n                    <div class="todo-item-edit"><span><i class="fa fa-pencil" aria-hidden="true"></i></span></div>\n                    <div class="todo-item-delete"><span><i class="fa fa-trash-o" aria-hidden="true"></i></span></div>\n                </div>\n            </div>\n            <div class="todo-item-completed"><span>Completed!</span></div>\n            <div class="todo-item-deleted"><span>Deleted!</span></div>\n        ',n.append(o),y(o.getElementsByClassName("todo-item-complete")[0]),f(o.getElementsByClassName("todo-item-edit")[0]),v(o.getElementsByClassName("todo-item-edit-field")[0]),g(o.getElementsByClassName("todo-item-edit-confirm")[0]),p(o.getElementsByClassName("todo-item-edit-cancel")[0]),E(o.getElementsByClassName("todo-item-delete")[0]),N(),l[a]={todo:e,created:t},h()},y=function(e){var t=e.parentNode.parentNode,n=e.parentNode,a=t.getElementsByClassName("todo-item-completed")[0];e.addEventListener("click",function(){a.height=t.height,a.classList.add("active"),n.classList.add("slide"),setTimeout(function(){t.remove(),r.daySummary.count++,r.weekSummary.count++,r.monthSummary.count++,r.yearSummary.count++,r.allSummary++,L(),B()},750)})},v=function(e){var t=e.parentNode.parentNode;e.addEventListener("keyup",function(n){if(13===n.keyCode){if(""===e.value)return;t.getElementsByClassName("todo-item-content")[0].innerHTML=e.value,t.getElementsByClassName("todo-item-content")[0].classList.remove("inactive"),t.getElementsByClassName("todo-item-content-edit")[0].classList.remove("active"),t.classList.remove("active"),B()}})},f=function(e){var t=e.parentNode.parentNode;e.addEventListener("click",function(){t.getElementsByClassName("todo-item-content")[0].classList.add("inactive"),t.getElementsByClassName("todo-item-edit-field")[0].value=t.getElementsByClassName("todo-item-content")[0].innerHTML,t.getElementsByClassName("todo-item-content-edit")[0].classList.add("active"),t.getElementsByClassName("todo-item-edit-field")[0].select(),t.classList.add("active")})},g=function(e){var t=e.parentNode.parentNode,n=t.getElementsByClassName("todo-item-edit-field")[0];e.addEventListener("click",function(){""!==n.value&&(t.getElementsByClassName("todo-item-content")[0].innerHTML=n.value,t.getElementsByClassName("todo-item-content")[0].classList.remove("inactive"),t.getElementsByClassName("todo-item-content-edit")[0].classList.remove("active"),t.classList.remove("active"),B())})},p=function(e){var t=e.parentNode.parentNode;e.addEventListener("click",function(){t.getElementsByClassName("todo-item-content")[0].classList.remove("inactive"),t.getElementsByClassName("todo-item-content-edit")[0].classList.remove("active"),t.getElementsByClassName("todo-item-edit")[0].getElementsByTagName("span")[0].classList.remove("active"),t.classList.remove("active")})},E=function(e){var t=e.parentNode.parentNode.parentNode,n=e.parentNode.parentNode;e.addEventListener("click",function(){t.getElementsByClassName("todo-item-deleted")[0].height=t.clientHeight,t.getElementsByClassName("todo-item-deleted")[0].classList.add("active"),n.classList.add("slide"),setTimeout(function(){t.remove(),B()},750)})},N=function(){e.value=""},L=function(){m.innerHTML=r.daySummary.count,s.innerHTML=r.weekSummary.count,i.innerHTML=r.monthSummary.count,d.innerHTML=r.yearSummary.count,c.innerHTML=r.allSummary},B=function(){var e=document.getElementsByClassName("todo-item");if(l={},e.length>0)for(var t=0;t<e.length;t++)e[t].id="todo-"+(t+1),l[t+1]={todo:e[t].getElementsByClassName("todo-item-content")[0].innerHTML,created:e[t].dataset.createdOn};h(),S()},h=function(){chrome.storage.sync.remove("list",function(){chrome.storage.sync.set({list:l},function(){console.log("List updated.")})})},C=function(){chrome.storage.sync.get("list",function(e){for(var t in e.list)if(e.list.hasOwnProperty(t)){var n=e.list[t];u(n.todo,n.created,t)}})},S=function(){chrome.storage.sync.remove("summary",function(){chrome.storage.sync.set({summary:r},function(){console.log("Summary updated.")})})},Y=function(){chrome.storage.sync.get("summary",function(e){if(void 0===e.summary)return void S();r=e.summary,M(),L(),S()})},M=function(){var e=moment();e.format("YYYY-MM-DD")!==r.daySummary.date&&(r.daySummary.count=0,r.daySummary.date=e.format("YYYY-MM-DD")),e.week()!==moment(r.weekSummary.date).week()&&(r.weekSummary.count=0,r.weekSummary.date=e.format("YYYY-MM-DD")),e.month()!==moment(r.monthSummary.date).month()&&(r.monthSummary.count=0,r.monthSummary.date=e.format("YYYY-MM-DD")),e.year()!==moment(r.yearSummary.date).year()&&(r.yearSummary.count=0,r.yearSummary.date=e.format("YYYY-MM-DD"))},k=function(){C(),Y(),e.addEventListener("keyup",function(t){if(13===t.keyCode){if(""===e.value)return;u(e.value,moment().format("YYYY-MM-DD"),document.getElementsByClassName("todo-item").length+1)}}),t.addEventListener("click",function(){""!==e.value&&u(e.value,moment().format("YYYY-MM-DD"),document.getElementsByClassName("todo-item").length+1)}),o.addEventListener("click",function(){a.classList.contains("active")?a.classList.remove("active"):a.classList.add("active")})};document.addEventListener("DOMContentLoaded",k)}();